## 摘要

图像几何变换又称为图像空间变换， 它将一幅图像中的坐标位置映射到另一幅图像中的新坐标位置。几何变换不改变图像的像素值， 只是在图像平面上进行像素的重新安排。

几何变换大致分为仿射变换、投影变换、极坐标变换，完成几何变换需要两个独立的算法过程：

1、一个用来实现空间坐标变换的算法，用它描述每个像素如何从初始位置移动到终止位置

2、一个插值算法完成输出图像的每个像素的灰度值

------

 **仿射变换**

 😀**首先，先来分析一下放射变换的原理：**

- ## **什么是仿射变换？**

仿射变换是从一个二维坐标系变换到另一个二维坐标系，属于线性变换。通过已知3对坐标点可以求得变换矩阵。(不共线的三对对应点，决定了唯一的变换矩阵）

![img](https://img2020.cnblogs.com/blog/2282730/202105/2282730-20210514103036262-812688668.png) **其中**![img](https://img2020.cnblogs.com/blog/2282730/202105/2282730-20210514103053885-1719232190.png) 

![A](https://math.jianshu.com/math?formula=A)就是仿射变换矩阵一般形式，根据不同的变换，比如平移、缩放、旋转等等，仿射变换矩阵的值是不一样的。



**因为是在2D进行变换，所以只需要对x,y方法进行线性映射，就是为什么第三位的向量是(0,0,1)**



**就是通过设定不同的映射矩阵A来实现旋转-平移-缩放等几何操作**



![img](http://www.opencv.org.cn/opencvdoc/2.3.2/html/_images/math/52dd2dbccca34f542d2bca6f720562aab1fe7ffc.png)





**1、平移**

假设空间坐标 (x，y)先沿 x轴平移tx ,在沿 y轴平移 ty,则变换后的坐标为（x+tx，y+ty） ,此时平移变换为：

![img](https://img2020.cnblogs.com/blog/2282730/202105/2282730-20210514104146449-312525965.png)

**2、缩放**

二维空间坐标 (x，y) 以任意一点 (x0，y0) 为中心在水平方向和垂直方向上分别缩放 sx和 sy倍，缩放后坐标为 (x0+sx (x-x0)，y0+sy(y-y0)) ，通俗来讲就是缩放后的坐标离中心点的水平距离变为原坐标离中心点水平距离的 sx 倍。

当 (x0，y0) 为原点 (0，0） 时，缩放变换可以表示为：         

 ![img](https://img2020.cnblogs.com/blog/2282730/202105/2282730-20210514105617161-1400297499.png)

当 (x0，y0) 为任意点 时，变换过程理解为，先将中心点平移到原点，再以原点为中心进行缩放，然后移回到原来的中心点。缩放变换表示为：

![img](https://img2020.cnblogs.com/blog/2282730/202105/2282730-20210514110008605-121117185.png)

注意：等式右边的运算应该从右往左看

 **3、旋转**

顺时针绕原点(0，0)旋转变换的矩阵表示为：

**![img](https://img2020.cnblogs.com/blog/2282730/202105/2282730-20210514110623948-874050388.png)**

若以任意一点 (x0，y0) 为中心旋转，相当于先将原点移动到旋转中心，然后绕原点旋转，最后移回坐标原点，用矩阵表示为：

![img](https://img2020.cnblogs.com/blog/2282730/202105/2282730-20210514110845989-1502990497.png)

注意：上面的运算顺序是从右向左的。

OpenCV提供的旋转函数，实现顺时针90°、180°、270°的旋转

```
rotate(InputArray src, Output dst, int rotateCode)

rotateCode有以下取值：
ROTATE_90_CLOCKWISE    //顺时针旋转90度
ROTATE_180             //顺时针旋转180度
ROTATE_90_COUNTERCLOCKWISE  //逆时针旋转90度
```

需要注意的是OpenCV还有一个函数为`flip(src, dst, int flipCode)`实现了图像的水平镜像、垂直镜像和逆时针旋转180°，不过并不是通过仿射变换实现的，而是通过行列互换，它与`rotate()`、`transpose()`函数一样都在core.hpp头文件中。